{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { User } from '../models/User';\nexport let WaiterComponent = class WaiterComponent {\n  constructor(router, userService, restaurantService) {\n    this.router = router;\n    this.userService = userService;\n    this.restaurantService = restaurantService;\n    this.page = 1;\n    this.user = new User();\n    this.error = \"\";\n    this.reservations = [];\n  }\n  ngOnInit() {\n    let p = localStorage.getItem(\"page\");\n    if (p) this.page = parseInt(p);\n    let temp = localStorage.getItem(\"user\");\n    if (temp) {\n      this.user = JSON.parse(temp);\n      if (this.user.type != \"waiter\") {\n        localStorage.removeItem(\"user\");\n        this.router.navigate([\"\"]);\n      }\n      if (this.user.accountStatus != 1) {\n        this.error = \"This account is not active!\";\n        localStorage.removeItem(\"user\");\n        this.router.navigate([\"\"]);\n      }\n    } else {\n      this.router.navigate([\"\"]);\n    }\n    this.restaurantService.getReservations().subscribe(data => {\n      this.reservations = data.filter(reservation => reservation.restaurantName === this.user.worksAt).sort((a, b) => {\n        return a.startTime < b.startTime ? -1 : 1;\n      });\n      this.reservations.forEach(reservation => {\n        reservation.startTime = new Date(reservation.startTime);\n        reservation.endTime = new Date(reservation.endTime);\n      });\n    });\n  }\n  navigateTo(newPage) {\n    this.page = newPage;\n  }\n  updateInfo() {\n    if (!this.user.forename || !this.user.surname || !this.user.address || !this.user.contactPhone || !this.user.email || !this.user.creditCardNumber) {\n      this.error = \"Fields can not be empty!\";\n      return;\n    }\n    this.userService.updateInfo(this.user.username, this.user.forename, this.user.surname, this.user.address, this.user.email, this.user.contactPhone, this.user.creditCardNumber).subscribe(data => {\n      if (data.msg === \"User information updated successfully!\") {\n        localStorage.setItem(\"user\", JSON.stringify(this.user));\n      }\n      alert(data.msg);\n      window.location.reload();\n    });\n  }\n  logout() {\n    localStorage.removeItem(\"page\");\n    localStorage.removeItem(\"user\");\n    this.router.navigate([\"\"]);\n  }\n};\nWaiterComponent = __decorate([Component({\n  selector: 'app-waiter',\n  templateUrl: './waiter.component.html',\n  styleUrls: ['./waiter.component.css']\n})], WaiterComponent);","map":{"version":3,"names":["Component","User","WaiterComponent","constructor","router","userService","restaurantService","page","user","error","reservations","ngOnInit","p","localStorage","getItem","parseInt","temp","JSON","parse","type","removeItem","navigate","accountStatus","getReservations","subscribe","data","filter","reservation","restaurantName","worksAt","sort","a","b","startTime","forEach","Date","endTime","navigateTo","newPage","updateInfo","forename","surname","address","contactPhone","email","creditCardNumber","username","msg","setItem","stringify","alert","window","location","reload","logout","__decorate","selector","templateUrl","styleUrls"],"sources":["E:\\ETF\\Domaci i Projekti\\PIA Projekat\\frontend\\src\\app\\waiter\\waiter.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { User } from '../models/User';\nimport { Router } from '@angular/router';\nimport { UserService } from '../services/user.service';\nimport { Reservation } from '../models/Reservation';\nimport { RestaurantService } from '../services/restaurant.service';\nimport { Restaurant } from '../models/Restaurant';\n\n@Component({\n  selector: 'app-waiter',\n  templateUrl: './waiter.component.html',\n  styleUrls: ['./waiter.component.css']\n})\nexport class WaiterComponent {\n  constructor(private router:Router, private userService: UserService, private restaurantService: RestaurantService)\n  {\n\n  }\n\n  ngOnInit(): void {\n    let p = localStorage.getItem(\"page\")\n    if (p)\n      this.page = parseInt(p)\n\n    let temp = localStorage.getItem(\"user\")\n    if(temp)\n    {\n      this.user = JSON.parse(temp);\n\n      if (this.user.type != \"waiter\")\n      {\n        localStorage.removeItem(\"user\")\n        this.router.navigate([\"\"]);\n      }\n\n      if (this.user.accountStatus != 1)\n      {\n        this.error = \"This account is not active!\"\n        localStorage.removeItem(\"user\")\n        this.router.navigate([\"\"]);\n      }\n\n    }\n    else\n    {\n      this.router.navigate([\"\"]);\n    }\n\n    this.restaurantService.getReservations().subscribe(data => {\n      this.reservations = data\n      .filter((reservation: Reservation) => \n        reservation.restaurantName === this.user.worksAt)\n      .sort((a: Reservation, b: Reservation) => {\n          return a.startTime < b.startTime ? -1 : 1;\n        })\n\n      this.reservations.forEach((reservation: Reservation) => {\n        reservation.startTime = new Date(reservation.startTime)\n        reservation.endTime = new Date(reservation.endTime)\n      })\n    })\n  }\n\n  page: number = 1\n  user: User = new User()\n  error: string = \"\"\n\n  reservations: Reservation[] = []\n\n  navigateTo(newPage: number)\n  {\n    this.page = newPage\n  }\n\n  updateInfo()\n  {\n    if (!this.user.forename || !this.user.surname || !this.user.address || !this.user.contactPhone ||\n      !this.user.email || !this.user.creditCardNumber) {\n      this.error = \"Fields can not be empty!\";\n      return;\n    }\n\n    this.userService.updateInfo(this.user.username, this.user.forename, this.user.surname, this.user.address, this.user.email, \n      this.user.contactPhone, this.user.creditCardNumber).subscribe((data:any) => {\n        if (data.msg === \"User information updated successfully!\")\n        {\n          localStorage.setItem(\"user\", JSON.stringify(this.user))\n        }\n\n        alert(data.msg)\n        window.location.reload();\n    })\n  }\n\n  logout()\n  {\n    localStorage.removeItem(\"page\")\n    localStorage.removeItem(\"user\")\n    this.router.navigate([\"\"])\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}